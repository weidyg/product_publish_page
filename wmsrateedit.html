<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title></title>
</head>

<body>
  <div id="wmsrateedit"></div>
  <script src="/assets/js/post.js"> </script>
  <script>

    const baseUrl = 'http://localhost:49050/api/services/app/RateConfig/';
    const productEditUrls = {
      loadData: baseUrl + "GetPolicyById",
      createPolicy: baseUrl + "CreatePolicy",
      updatePolicy: baseUrl + "UpdatePolicy",
    }

    const options = {
      stores: [
        { label: '奇门正式测试', value: 1471 },
        { label: '青创网A099仓', value: 1545 },
        { label: '青创网A100仓', value: 1659 },
      ],
      expenseTypes: [
        { label: '销售出库快递费', value: 10 },
        { label: '操作费', value: 20 },
        { label: '物料费', value: 30 },
        { label: '储存费', value: 40 },
      ],
      calculateRules: [
        { label: '固定费用', value: 10 },
        { label: '数量区间', value: 20 },
        { label: '重量区间', value: 30 },
      ],
    }
    function getRateConfigOptions() {
      return new Promise((resolve, reject) => {
        setTimeout(() => {
          resolve(options);
        }, 2000);
      })
    }

    function loadRateConfigPolicy(id) {
      id = id || getQueryString('id');
      if (id > 0) {
        var input = { id: id, includeDetails: true }
        return post(productEditUrls.loadData, input);
      }
      return Promise.resolve({});
    }

    function saveRateConfigPolicy(value) {
      var url = value.id > 0
        ? productEditUrls.updatePolicy
        : productEditUrls.createPolicy;
      value.includeDetails = true;
      return post(url, value);
    }

    function cancelRateConfigPolicy() {
      // window.history.back();
    }

    function convertRateConfigType(calculateRule, expenseType) {
      const isFixedFee = calculateRule == 10;
      const isIntervalFee = (calculateRule >= 0 && calculateRule != 10);
      const isWeight = calculateRule == 30;
      const isStorageFee = expenseType == 40;
      console.log('convertRateConfigType', calculateRule, expenseType);
      console.log('convertRateConfigType', isFixedFee, isIntervalFee, isWeight, isStorageFee);
      return { isFixedFee, isIntervalFee, isWeight, isStorageFee }
    }
  </script>
  <script type="module" src="/src/pages/wms/rateConfigPolicy/edit/main.tsx"></script>
</body>

</html>